"use strict";(self.webpackChunkcollider_client=self.webpackChunkcollider_client||[]).push([[227],{227:(e,a,i)=>{i.r(a),i.d(a,{default:()=>o});var n=i(950),s=i(429),t=i(74),l=i(921),r=i(414);const c=()=>{const{equipment:e,loading:a,error:i,filters:s,fetchEquipment:c,removeEquipment:d,setFilters:m}=(0,l.C)(),[o,u]=n.useState(null);(0,n.useEffect)((()=>{c()}),[s,c]);const h=e=>({available:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e",unavailable:"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",maintenance:"\u041d\u0430 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0438"}[e]||e);return a?(0,r.jsx)("div",{className:"admin-loading",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f..."}):(0,r.jsxs)("div",{className:"admin-equipment-list",children:[(0,r.jsxs)("div",{className:"admin-equipment-header",children:[(0,r.jsx)("h2",{children:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435\u043c"}),(0,r.jsx)(t.N_,{to:"/admin/equipment/create",className:"admin-btn admin-btn-primary",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435"})]}),i&&(0,r.jsx)("div",{className:"admin-error-message",children:i}),(0,r.jsxs)("div",{className:"admin-equipment-filters",children:[(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f:"}),(0,r.jsxs)("select",{value:s.category||"all",onChange:e=>{return a=e.target.value,void m({...s,category:a});var a},children:[(0,r.jsx)("option",{value:"all",children:"\u0412\u0441\u0435 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438"}),(0,r.jsx)("option",{value:"sound",children:"\u0417\u0432\u0443\u043a"}),(0,r.jsx)("option",{value:"light",children:"\u0421\u0432\u0435\u0442"}),(0,r.jsx)("option",{value:"stage",children:"\u0421\u0446\u0435\u043d\u0430"}),(0,r.jsx)("option",{value:"other",children:"\u041f\u0440\u043e\u0447\u0435\u0435"})]})]}),(0,r.jsxs)("div",{className:"filter-group",children:[(0,r.jsx)("label",{children:"\u0421\u0442\u0430\u0442\u0443\u0441:"}),(0,r.jsxs)("select",{value:s.status||"all",onChange:e=>{return a=e.target.value,void m({...s,status:a});var a},children:[(0,r.jsx)("option",{value:"all",children:"\u0412\u0441\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u044b"}),(0,r.jsx)("option",{value:"available",children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e"}),(0,r.jsx)("option",{value:"unavailable",children:"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e"}),(0,r.jsx)("option",{value:"maintenance",children:"\u041d\u0430 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0438"})]})]})]}),0===e.length?(0,r.jsx)("div",{className:"admin-empty-list",children:"\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}):(0,r.jsx)("div",{className:"admin-equipment-table-container",children:(0,r.jsxs)("table",{className:"admin-equipment-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}),(0,r.jsx)("th",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),(0,r.jsx)("th",{children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"}),(0,r.jsx)("th",{children:"\u0426\u0435\u043d\u0430"}),(0,r.jsx)("th",{children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),(0,r.jsx)("th",{children:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f"})]})}),(0,r.jsx)("tbody",{children:e.map((e=>{return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"equipment-image-cell",children:(0,r.jsx)("img",{src:e.images&&e.images.length>0?e.images[0]:"/images/equipment-placeholder.jpg",alt:e.name,className:"equipment-thumbnail"})}),(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:(i=e.category,{sound:"\u0417\u0432\u0443\u043a",light:"\u0421\u0432\u0435\u0442",stage:"\u0421\u0446\u0435\u043d\u0430",other:"\u041f\u0440\u043e\u0447\u0435\u0435"}[i]||i)}),(0,r.jsxs)("td",{children:[e.price," \u0433\u0440\u043d / ","hour"===e.priceUnit?"\u0447\u0430\u0441":"day"===e.priceUnit?"\u0434\u0435\u043d\u044c":"\u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"]}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:`equipment-status ${a=e.status,{available:"status-available",unavailable:"status-unavailable",maintenance:"status-maintenance"}[a]||""}`,children:h(e.status)})}),(0,r.jsxs)("td",{className:"equipment-actions",children:[(0,r.jsx)(t.N_,{to:`/admin/equipment/edit/${e._id}`,className:"admin-btn admin-btn-small admin-btn-secondary",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),(0,r.jsx)("button",{onClick:()=>u(e),className:"admin-btn admin-btn-small admin-btn-danger",children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]},e._id);var a,i}))})]})}),o&&(0,r.jsx)("div",{className:"admin-equipment-modal-overlay",children:(0,r.jsxs)("div",{className:"admin-equipment-modal",children:[(0,r.jsx)("h3",{className:"admin-equipment-modal-title",children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f"}),(0,r.jsxs)("div",{className:"admin-equipment-modal-content",children:[(0,r.jsxs)("p",{children:['\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 "',o.name,'"?']}),(0,r.jsx)("p",{children:"\u042d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043d\u0435\u043b\u044c\u0437\u044f \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043c\u0435\u043d\u0438\u0442\u044c."})]}),(0,r.jsxs)("div",{className:"admin-equipment-modal-actions",children:[(0,r.jsx)("button",{className:"admin-equipment-modal-button admin-equipment-modal-button-cancel",onClick:()=>u(null),children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,r.jsx)("button",{className:"admin-equipment-modal-button admin-equipment-modal-button-delete",onClick:()=>{(async e=>{if(window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u0442\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435?"))try{await d(e)}catch(a){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f:",a)}})(o._id),u(null)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]})})]})};var d=i(271);const m=()=>{const{id:e}=(0,s.g)(),a=(0,s.Zp)(),i=Boolean(e),{currentEquipment:t,loading:l,error:c,fetchEquipmentById:m,addEquipment:o,editEquipment:u}=(0,d.Cy)(),[h,p]=(0,n.useState)({name:"",category:"sound",description:"",price:"",priceUnit:"day",status:"available",specifications:{}}),[j,x]=(0,n.useState)([]),[v,g]=(0,n.useState)([]),[b,N]=(0,n.useState)(i),[f,y]=(0,n.useState)(""),[q,C]=(0,n.useState)({}),[k,w]=(0,n.useState)([{key:"",value:""}]),U=(0,n.useCallback)((async()=>{try{N(!0),await m(e)}catch(f){y("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f")}finally{N(!1)}}),[m,e]);(0,n.useEffect)((()=>{i&&U()}),[i,U]),(0,n.useEffect)((()=>{if(t&&i){p({name:t.name,category:t.category,description:t.description,price:t.price,priceUnit:t.priceUnit,status:t.status,specifications:t.specifications||{}});const e=Object.entries(t.specifications||{}).map((e=>{let[a,i]=e;return{key:a,value:i}}));e.length>0&&w(e),t.images&&t.images.length>0&&g(t.images)}}),[t,i]);const E=e=>{const{name:a,value:i}=e.target;p((e=>({...e,[a]:i}))),q[a]&&C((e=>({...e,[a]:""})))},S=(e,a,i)=>{const n=[...k];n[e][a]=i,w(n)};return(b||l)&&i?(0,r.jsx)("div",{className:"admin-loading",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f..."}):(0,r.jsxs)("div",{className:"admin-equipment-form-container",children:[(0,r.jsx)("h2",{children:i?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"}),(f||c)&&(0,r.jsx)("div",{className:"admin-error-message",children:f||c}),(0,r.jsxs)("form",{className:"admin-equipment-form",onSubmit:async n=>{if(n.preventDefault(),(()=>{const e={};return h.name.trim()||(e.name="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"),h.description.trim()||(e.description="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"),(!h.price||h.price<=0)&&(e.price="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0443\u044e \u0446\u0435\u043d\u0443"),C(e),0===Object.keys(e).length})()){N(!0),y("");try{const n=k.reduce(((e,a)=>(a.key&&a.value&&(e[a.key]=a.value),e)),{}),s={...h,specifications:n};j.length>0&&(s.images=j),i?await u(e,s):await o(s),a("/admin/equipment")}catch(f){let a="\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f";f.response&&f.response.data?a=f.response.data.error||a:f.error&&(a=f.error),console.error("\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430:",f),y(a),N(!1)}}else y("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u0444\u043e\u0440\u043c\u0435")},children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"name",children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f *"}),(0,r.jsx)("input",{type:"text",id:"name",name:"name",value:h.name,onChange:E,className:q.name?"input-error":"",required:!0}),q.name&&(0,r.jsx)("div",{className:"error-message",children:q.name})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"category",children:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f *"}),(0,r.jsxs)("select",{id:"category",name:"category",value:h.category,onChange:E,required:!0,children:[(0,r.jsx)("option",{value:"sound",children:"\u0417\u0432\u0443\u043a"}),(0,r.jsx)("option",{value:"light",children:"\u0421\u0432\u0435\u0442"}),(0,r.jsx)("option",{value:"stage",children:"\u0421\u0446\u0435\u043d\u0430"}),(0,r.jsx)("option",{value:"other",children:"\u041f\u0440\u043e\u0447\u0435\u0435"})]})]}),(0,r.jsxs)("div",{className:"form-group full-width",children:[(0,r.jsx)("label",{htmlFor:"description",children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f *"}),(0,r.jsx)("textarea",{id:"description",name:"description",value:h.description,onChange:E,rows:"5",className:q.description?"input-error":"",required:!0}),q.description&&(0,r.jsx)("div",{className:"error-message",children:q.description})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"price",children:"\u0426\u0435\u043d\u0430 \u0430\u0440\u0435\u043d\u0434\u044b *"}),(0,r.jsx)("input",{type:"number",id:"price",name:"price",value:h.price,onChange:E,required:!0,min:"0",className:q.price?"input-error":""}),q.price&&(0,r.jsx)("div",{className:"error-message",children:q.price})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"priceUnit",children:"\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0430\u0440\u0435\u043d\u0434\u044b *"}),(0,r.jsxs)("select",{id:"priceUnit",name:"priceUnit",value:h.priceUnit,onChange:E,required:!0,children:[(0,r.jsx)("option",{value:"hour",children:"\u0417\u0430 \u0447\u0430\u0441"}),(0,r.jsx)("option",{value:"day",children:"\u0417\u0430 \u0434\u0435\u043d\u044c"}),(0,r.jsx)("option",{value:"event",children:"\u0417\u0430 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{htmlFor:"status",children:"\u0421\u0442\u0430\u0442\u0443\u0441 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f *"}),(0,r.jsxs)("select",{id:"status",name:"status",value:h.status,onChange:E,required:!0,children:[(0,r.jsx)("option",{value:"available",children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e"}),(0,r.jsx)("option",{value:"unavailable",children:"\u041d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e"}),(0,r.jsx)("option",{value:"maintenance",children:"\u041d\u0430 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0438"})]})]}),(0,r.jsxs)("div",{className:"form-group full-width",children:[(0,r.jsx)("label",{children:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"}),(0,r.jsx)("input",{type:"file",name:"images",onChange:e=>{const a=Array.from(e.target.files);x(a);const i=a.map((e=>URL.createObjectURL(e)));g(i)},multiple:!0,accept:"image/*"}),v.length>0&&(0,r.jsx)("div",{className:"image-previews",children:v.map(((e,a)=>(0,r.jsx)("div",{className:"image-preview-item",children:(0,r.jsx)("img",{src:e,alt:`Preview ${a}`})},a)))})]}),(0,r.jsxs)("div",{className:"form-group full-width specifications-container",children:[(0,r.jsx)("label",{children:"\u0421\u043f\u0435\u0446\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"}),k.map(((e,a)=>(0,r.jsxs)("div",{className:"specification-row",children:[(0,r.jsx)("input",{type:"text",placeholder:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0430",value:e.key,onChange:e=>S(a,"key",e.target.value)}),(0,r.jsx)("input",{type:"text",placeholder:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435",value:e.value,onChange:e=>S(a,"value",e.target.value)}),(0,r.jsx)("button",{type:"button",className:"admin-btn admin-btn-small admin-btn-danger",onClick:()=>(e=>{if(k.length>1){const a=k.filter(((a,i)=>i!==e));w(a)}})(a),children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]},a))),(0,r.jsx)("button",{type:"button",className:"admin-btn admin-btn-secondary add-spec-btn",onClick:()=>{w([...k,{key:"",value:""}])},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043f\u0435\u0446\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044e"})]}),(0,r.jsxs)("div",{className:"form-buttons",children:[(0,r.jsx)("button",{type:"button",className:"admin-btn admin-btn-secondary",onClick:()=>a("/admin/equipment"),children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,r.jsx)("button",{type:"submit",className:"admin-btn admin-btn-primary",disabled:b||l,children:b||l?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})]})},o=()=>(0,r.jsxs)(s.BV,{children:[(0,r.jsx)(s.qh,{path:"/",element:(0,r.jsx)(c,{})}),(0,r.jsx)(s.qh,{path:"/create",element:(0,r.jsx)(m,{})}),(0,r.jsx)(s.qh,{path:"/edit/:id",element:(0,r.jsx)(m,{})}),(0,r.jsx)(s.qh,{path:"*",element:(0,r.jsx)(s.C5,{to:"/admin/equipment",replace:!0})})]})}}]);